/**
 * skylark-loopprotect - A version of jsbin-loopprotect playground) that ported to running on skylarkjs.
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylarkn-loopprotect/
 * @license MIT
 */
define([],function(){"use strict";var e=null,n=/\b(for|while|do)\b/g,i=/\b(for|while|do)\b/,t=/\b(?!default:)([a-z_]{1}\w+:)/i,r=/(?:\/\*(?:[\s\S]*?)\*\/)|(?:([\s;])+\/\/(?:.*)$)/gm,o=function(u,a){var f=[],c=u.split("\n"),g=!1,h=o.alias+".protect",d={},b={},p=null;function E(e,n,i){return n.slice(0,i)+"{;"+h+"({ line: "+e+", reset: true }); "+n.slice(i)}a||(a=0);return c.forEach(function(o,u){if(n.lastIndex=0,t.lastIndex=0,!g){-1!==o.toLowerCase().indexOf("noprotect")&&(g=!0);var B=-1,D=-1,G=u,U=u-a+1,m="",v=!1,x=!1,w=!1,O=o.match(n)||[],k=O.length?O[0]:"",y=o.match(t)||[],j=0,I=0,L=!1;if(y.length&&(DEBUG&&e("- label match"),s(B=o.indexOf(y[1]),o)?DEBUG&&e("- ignored label in string or comment"):l(u,c)?DEBUG&&e("- ignored label in multline comment"):function(n,o,l){i.lastIndex=0,t.lastIndex=0;var s=!1,u=l.slice(o).join("\n").substr(n).replace(t,"");return u.replace(i,function(n,i,t){var o=u.substr(0,t).replace(r,"").trim();DEBUG&&e("- directlyBeforeLoop: "+o),0===o.length&&(s=!0)}),s}(B,u,c)?(DEBUG&&e('- found a label: "'+y[0]+'"'),p=u):DEBUG&&e('- ignored "label", false positive')),d[u])DEBUG&&e(" -exit: ignoring line "+u+": "+o);else{if(b[u])return DEBUG&&e("- exit: ignoring, but adding line "+u+": "+o),void f.push(o);if(k&&1===O.length&&-1===o.indexOf("jsbin")){if(DEBUG&&e("match on "+k+"\n"),v="do"===k,D=B=o.indexOf(k),s(B,o))return void f.push(o);if(l(u,c))return void f.push(o);for((B=o.indexOf(k)+k.length)===o.length&&B===o.length&&u<c.length-1&&(DEBUG&&e("- moving to next line"),f.push(o),o=c[++u],d[u]=!0,B=0);B<o.length;){if("("===(m=o.substr(B,1))&&j++,")"===m&&0==--j&&!1===w&&(w=B),"{"===m&&I++,"}"===m&&I--,0===j&&(";"===m||"{"===m)){if(";"===m)u!==G?(DEBUG&&e("- multiline inline loop"),f[G]=f[G].substring(0,w+1)+"{\nif ("+h+"({ line: "+U+" })) break;\n"+f[G].substring(w+1),o+="\n}}\n"):(DEBUG&&e("- single line inline loop"),o=o.substring(0,w+1)+"{\nif ("+h+"({ line: "+U+" })) break;\n"+o.substring(w+1)+"\n}}\n"),L=!0;else if("{"===m){DEBUG&&e("- multiline with braces");var T=";\nif ("+h+"({ line: "+U+" })) break;\n";o=o.substring(0,B+1)+T+o.substring(B+1),B+=T.length}if(u===G&&null===p?(DEBUG&&e("- simple reset insert"),o=E(U,o,D),B+=(";"+h+"({ line: "+u+", reset: true }); ").length):null===p?(DEBUG&&e("- reset inserted above original line"),f[G]=E(U,f[G],D)):(DEBUG&&e("- reset inserted above matched label on line "+p),void 0===f[p]&&(p--,D=0),f[p]=E(U,f[p],D),p=null),v){for(DEBUG&&e("searching for closing `while` statement for: "+o),x=!1;B<o.length;){if("{"===(m=o.substr(B,1))&&I++,"}"===m&&I--,x=0===I,0===I&&DEBUG&&e("outside of closure, looking for `while` statement: "+o),x&&-1!==o.indexOf("while"))return DEBUG&&e("- exit as we found `while`: "+o),o+="}",f.push(o),void(d[u]=!0);++B===o.length&&u<c.length-1&&(f.push(o),d[u]=!0,o=c[++u],DEBUG&&e(o),B=0)}return}if(L)return void f.push(o);for(DEBUG&&e("searching for closing brace of loop for: "+o);null!==o;){if(m=o.substr(B,1),DEBUG&&e(B,m,I),"{"===m&&I++,"}"===m&&0==--I)return DEBUG&&e("outside of loop, add a close brace to: "+o),o=o.substring(0,B+1)+"}"+o.substring(B+1),f.push(o),void(d[u]=!0);++B>=o.length&&(f.push(o),d[u]=!0,o=c[++u],DEBUG&&e(o),B=0)}return}++B===o.length&&u<c.length-1&&(DEBUG&&e("- moving to next line"),f.push(o),o=c[++u],d[u]=!0,B=0)}}else DEBUG&&e("regular line "+o),f.push(o)}}}),DEBUG&&e("---- source ----"),DEBUG&&e(u),DEBUG&&e("---- rewrite ---"),DEBUG&&e(f.join("\n")),DEBUG&&e(""),g?u:f.join("\n")};function l(n,i){if(0===n)return!1;var t=n,r=1,o=-1,l=-1;do{if(DEBUG&&e("looking backwards "+i[t]),o=i[t].indexOf("*/"),l=i[t].indexOf("/*"),-1!==o&&r++,o===i[t].length-2&&-1!==l&&r--,-1!==l&&0===--r)return DEBUG&&e("- exit: part of a multiline comment"),!0;t-=1}while(0!==t);return!1}function s(n,i){for(var t;--n>-1;){if('"'===(t=i.substr(n,1))||"'"===t||"."===t)return DEBUG&&e("- exit: matched inside a string or property key"),!0;if(("/"===t||"*"===t)&&(--n,"/"===t))return DEBUG&&e("- exit: part of a comment"),!0}return!1}return o.counters={},o.debug=function(n){e=n?function(){console.log.apply(console,[].slice.apply(arguments))}:function(){}},o.debug(!1),o.alias="loopProtect",o.protect=function(e){o.counters[e.line]=o.counters[e.line]||{};var n=o.counters[e.line],i=(new Date).getTime();return e.reset&&(n.time=i,n.hit=0,n.last=0),n.hit++,i-n.time>100?(o.hit(e.line),!0):(n.last++,!1)},o.hit=function(e){var n="Exiting potential infinite loop at line "+e+'. To disable loop protection: add "// noprotect" to your code';console.error(n)},o.reset=function(){o.counters={}},o});
//# sourceMappingURL=sourcemaps/main.js.map
